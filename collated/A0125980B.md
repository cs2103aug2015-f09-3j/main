# A0125980B
###### src\application\controller\DataManager.java
``` java

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Collections;
import java.util.Date;
import java.util.HashMap;
import java.util.Stack;

import com.google.gson.Gson;

import application.controller.parser.ParserFacade;
import application.model.Command;
import application.model.LocalStorage;
import application.model.Parameter;
import application.model.Task;

import application.utils.GoogleCalendarUtility;
import application.utils.TokenManager;

public class DataManager {
	public static final Integer WRONG_LINE_NUM = -5;
	public static final Integer NO_PREV_COMMAND = -4;
	public static final Integer TASK_ALREADY_EXISTS = -3;
	public static final Integer MULTIPLE_MATCHES = -2;
	public static final Integer TASK_NOT_FOUND = -1;
	public static final Integer TASK_REMOVED = 1;
	public static final Integer TASK_ADDED = 2;
	public static final Integer TASK_SET_TO_DONE = 3;
	public static final Integer TASK_UPDATED = 4;
	public static final Integer PREV_COMMAND_UNDONE = 5;
	public static final Integer TASK_UNDONE = 6;
	public static final Integer MAX_HISTORY = 10;

	private static Data data;
	private ArrayList<Parameter> paraList;
	private Stack<Operation> history;
	private int histCount;

	public static DataManager instance = null;

	private DataManager() {
		data = new Data();
		paraList = null;
		history = new Stack<Operation>();
		histCount = 0;
	}

	public static DataManager getInstance() {
		if (instance == null) {
			instance = new DataManager();
		}
		return instance;
	}

```
###### src\application\controller\DataManager.java
``` java

	public Integer addNewTask(Task taskToAdd) {
		data.clearSearchList();
		if (data.getTaskList().contains(taskToAdd)) {
			return TASK_ALREADY_EXISTS;
		} else {
			data.addToData(taskToAdd);
			updateHistory(taskToAdd, null, Op.ADD);
			return TASK_ADDED;
		}
	}

	public ArrayList<Task> listAll(Command cmd) {
		data.clearSearchList();
		ArrayList<Task> filteredList = new ArrayList<Task>();
		if (cmd.getParameter().size() == 0) {
			for (Task task : data.getTaskList()) {
				if (!task.isDone()) {
					filteredList.add(task);
				}
			}
		} else {
			ArrayList<Parameter> parameter = new ArrayList<Parameter>();
			parameter = cmd.getParameter();
			filterListByParameter(filteredList, parameter);
		}
		sort(filteredList);
		return filteredList;
	}

	public ArrayList<Task> checkIfDone() {
		data.clearSearchList();
		ArrayList<Task> list = new ArrayList<Task>();
		for (Task task : data.getTaskList()) {
			if (task.isDone()) {
				list.add(task);
			}
		}
		return list;
	}

	private void filterListByParameter(ArrayList<Task> filteredList, ArrayList<Parameter> parameter) {
		for (Parameter para : parameter) {
			switch (para.getParaType()) {
			case Parameter.PRIORITY_ARGUMENT_TYPE:
				for (Task task : data.getTaskList()) {
					if (task.getPriority_argument().equals(para.getParaArg())) {
						if (!filteredList.contains(task)) {
							filteredList.add(task);
						}
					}
				}
				break;
			case Parameter.TYPE_ARGUMENT_TYPE:
				for (Task task : data.getTaskList()) {
					if (task.getType_argument().equals(para.getParaArg())) {
						if (!filteredList.contains(task)) {
							filteredList.add(task);
						}
					}
				}
				break;
			case Parameter.START_DATE_ARGUMENT_TYPE:
				for (Task task : data.getTaskList()) {
					if (para.getParaArg().equals("")) {
						if (task.getStart_date() == null) {
							if (!filteredList.contains(task)) {
								filteredList.add(task);
							}
						}
					} else {
						if (task.getStart_date() != null) {
							if (task.getStart_date().equals(ParserFacade.getInstance().parseDate(para.getParaArg()))) {
								if (!filteredList.contains(task)) {
									filteredList.add(task);
								}
							}
						}
					}
				}
				break;
			case Parameter.END_DATE_ARGUMENT_TYPE:
				for (Task task : data.getTaskList()) {
					if (para.getParaArg().equals("")) {
						if (task.getEnd_date() == null) {
							if (!filteredList.contains(task)) {
								filteredList.add(task);
							}
						}
					} else {
						if (task.isNonFloatingTask()) {
							if (task.getEnd_date().equals(ParserFacade.getInstance().parseDate(para.getParaArg()))) {
								if (!filteredList.contains(task)) {
									filteredList.add(task);
								}
							}
						}
					}
				}
				break;
			default:
				for (Task task : data.getTaskList()) {
					if (task.getPlace_argument().equals(para.getParaArg())) {
						if (!filteredList.contains(task)) {
							filteredList.add(task);
						}
					}
				}
				break;
			}
		}
	}

	public Integer removeTask(Command cmd) {
		data.clearSearchList();
		ArrayList<Task> searchList = searchTasksForMatches(cmd);
		data.saveToSearchList(searchList);
		switch (searchList.size()) {
		case 0:
			return TASK_NOT_FOUND;
		case 1:
			data.removeFromData(searchList.get(0));
			updateHistory(searchList.get(0), null, Op.DELETE);
			if (searchList.get(0).getgCalId() != null && !searchList.get(0).getgCalId().equals("")) {
				if (GoogleCalendarUtility.hasInternetConnection()) {
					GoogleCalendarManager.getInstance().removeTaskFromServer(searchList.get(0).getgCalId());
				} else {
					GoogleCalendarUtility.addToOfflineDeletionRecords(searchList.get(0).getgCalId());
				}
			}
			return TASK_REMOVED;
		default:
			CommandManager.setMultipleMatchList(searchList);
			return MULTIPLE_MATCHES;
		}

	}

	public Integer removeTask(int lineNum) {
		if (lineNum > data.getSearchList().size()) {
			return WRONG_LINE_NUM;
		}
		data.removeFromData(data.getSearchList().get(lineNum - 1));
		updateHistory(data.getSearchList().get(lineNum - 1), null, Op.DELETE);
		if (data.getSearchList().get(lineNum - 1).getgCalId() != null
				&& !data.getSearchList().get(lineNum - 1).getgCalId().equals("")) {
			if (GoogleCalendarUtility.hasInternetConnection()) {
				GoogleCalendarManager.getInstance()
						.removeTaskFromServer(data.getSearchList().get(lineNum - 1).getgCalId());
			} else {
				GoogleCalendarUtility.addToOfflineDeletionRecords(data.getSearchList().get(lineNum - 1).getgCalId());
			}
		}
		return TASK_REMOVED;
	}

	public Integer editTask(Command cmd) {
		data.clearSearchList();
		ArrayList<Task> searchList = searchTasksForMatches(cmd);
		data.saveToSearchList(searchList);
		paraList = cmd.getParameter();
		switch (searchList.size()) {
		case 0:
			return TASK_NOT_FOUND;
		case 1:
			ArrayList<Task> taskList = data.getTaskList();
			Task newTask, prevTask;
			prevTask = copyTask(searchList.get(0));
			for (Parameter para : paraList) {
				editTaskByParameter(1,taskList,searchList,para);
			}
			newTask = searchList.get(0);
			updateHistory(newTask, prevTask, Op.EDIT);
			taskList.get(taskList.indexOf(searchList.get(0))).setLastLocalUpdate(System.currentTimeMillis());
			data.updateStorage();
			return TASK_UPDATED;
		default:
			CommandManager.setMultipleMatchList(searchList);
			return MULTIPLE_MATCHES;
		}
	}

	public Integer editTask(int lineNum) {
		if (lineNum > data.getSearchList().size()) {
			return WRONG_LINE_NUM;
		}
		ArrayList<Task> taskList = data.getTaskList();
		ArrayList<Task> searchList = data.getSearchList();
		Task newTask, prevTask;
		prevTask = copyTask(searchList.get(lineNum - 1));
		for (Parameter para : paraList) {
			editTaskByParameter(lineNum, taskList, searchList, para);
		}
		newTask = searchList.get(lineNum - 1);
		updateHistory(newTask, prevTask, Op.EDIT);
		data.updateStorage();
		return TASK_UPDATED;
	}

	private void editTaskByParameter(int lineNum, ArrayList<Task> taskList, 
				ArrayList<Task> searchList,	Parameter para) {
		switch (para.getParaType()) {
		case Parameter.PRIORITY_ARGUMENT_TYPE:
			taskList.get(taskList.indexOf(searchList.get(lineNum - 1))).setPriority_argument(para.getParaArg());
			break;
		case Parameter.TYPE_ARGUMENT_TYPE:
			taskList.get(taskList.indexOf(searchList.get(lineNum - 1))).setType_argument(para.getParaArg());
			break;
		case Parameter.START_DATE_ARGUMENT_TYPE:
			taskList.get(taskList.indexOf(searchList.get(lineNum - 1)))
					.setStart_date(ParserFacade.getInstance().parseDate(para.getParaArg()));
			break;
		case Parameter.END_DATE_ARGUMENT_TYPE:
			taskList.get(taskList.indexOf(searchList.get(lineNum - 1)))
					.setEnd_date(ParserFacade.getInstance().parseDate(para.getParaArg()));
			break;
		default:
			taskList.get(taskList.indexOf(searchList.get(lineNum - 1))).setPlace_argument(para.getParaArg());
			break;
		}
	}

	public Integer setDoneToTask(Command cmd) {
		data.clearSearchList();
		ArrayList<Task> searchList = searchUndoneTasksForMatches(cmd);
		data.saveToSearchList(searchList);
		ArrayList<Task> taskList = data.getTaskList();
		switch (searchList.size()) {
		case 0:
			return TASK_NOT_FOUND;
		case 1:
			int index = taskList.indexOf(searchList.get(0));
			taskList.get(index).setDone(true);
			updateHistory(searchList.get(0), null, Op.SETDONE);
			data.updateStorage();
			return TASK_SET_TO_DONE;
		default:
			CommandManager.setMultipleMatchList(searchList);
			return MULTIPLE_MATCHES;
		}
	}

	public Integer setDoneToTask(int lineNum) {
		if (lineNum > data.getSearchList().size()) {
			return WRONG_LINE_NUM;
		}
		data.getSearchList().get(lineNum - 1).setDone(true);
		updateHistory(data.getSearchList().get(lineNum - 1), null, Op.SETDONE);
		data.updateStorage();
		return TASK_SET_TO_DONE;
	}

	public Integer changeStorageLocation(Command cmd) {
		data.clearSearchList();
		return data.changeFileLocation(cmd.getTextContent());
	}

	public Integer undoPrevCommand() {
		data.clearSearchList();
		if (history.empty()) {
			return NO_PREV_COMMAND;
		} else {
			Operation oper = history.pop();
			oper.undo(data);
			histCount--;
			return PREV_COMMAND_UNDONE;
		}
	}

	@SuppressWarnings("deprecation")
	public ArrayList<Task> listToday(Command cmd) {
		Date today = new Date();
		ArrayList<Task> tasksDueToday = new ArrayList<Task>();

		for (Task task : data.getTaskList()) {
			if (!task.isDone()) {
				if (task.isNonFloatingTask()) {
					if (task.getEnd_date().getYear() == today.getYear()) {
						if (task.getEnd_date().getMonth() == today.getMonth()) {
							if (task.getEnd_date().getDate() == today.getDate()) {
								tasksDueToday.add(task);
							}
						}
					}
					if (tasksDueToday.size() > 10) {
						break;
					}
				}
			}
		}
		return tasksDueToday;
	}

	public ArrayList<Task> searchTasks(Command cmd) {
		return searchTasksForMatches(cmd);
	}

	public int setUndoneToTask(int lineNum) {
		if (lineNum > data.getSearchList().size()) {
			return WRONG_LINE_NUM;
		}
		data.getSearchList().get(lineNum - 1).setDone(false);
		updateHistory(data.getSearchList().get(lineNum - 1), null, Op.UNDONE);
		data.updateStorage();
		return TASK_UNDONE;
	}

	public int setUndoneToTask(Command cmd) {
		data.clearSearchList();
		ArrayList<Task> searchList = searchDoneTasksForMatches(cmd);
		data.saveToSearchList(searchList);
		ArrayList<Task> taskList = data.getTaskList();
		switch (searchList.size()) {
		case 0:
			return TASK_NOT_FOUND;
		case 1:
			int index = taskList.indexOf(searchList.get(0));
			taskList.get(index).setDone(false);
			updateHistory(searchList.get(0), null, Op.UNDONE);
			data.updateStorage();
			return TASK_UNDONE;
		default:
			CommandManager.setMultipleMatchList(searchList);
			return MULTIPLE_MATCHES;
		}
	}

	private Task copyTask(Task task1) {
		Task task2 = new Task();
		task2 = new Task(task1.getTextContent());
		task2.setDone(task1.isDone());
		task2.setPriority_argument(new String(task1.getPriority_argument()));
		task2.setType_argument(new String(task1.getType_argument()));
		task2.setPlace_argument(new String(task1.getPlace_argument()));
		task2.setStart_date(task1.getStart_date());
		task2.setEnd_date(task1.getEnd_date());
		task2.setgCalId(task1.getgCalId());
		task2.setLastServerUpdate(task1.getLastServerUpdate());
		task2.setLastLocalUpdate(task1.getLastLocalUpdate());
		return task2;
	}

	private void updateHistory(Task task1, Task task2, Op oper) {
		history.push(new Operation(task1, task2, oper));
		histCount++;
		limitHistory();
	}

	private void limitHistory() {
		Stack<Operation> tempStack = new Stack<Operation>();
		if (histCount > DataManager.MAX_HISTORY) {
			while (!history.empty()) {
				tempStack.push(history.pop());
			}
			tempStack.pop();
			while (!tempStack.empty()) {
				history.push(tempStack.pop());
			}
			histCount--;
		}
	}

	private ArrayList<Task> searchTasksForMatches(Command cmd) {
		ArrayList<Task> searchList = new ArrayList<Task>();
		for (Task task: data.getTaskList()) {
			if (task.getTextContent().contains(cmd.getTextContent())) {
				searchList.add(task);
			}
		}
		return searchList;
	}
	
	private ArrayList<Task> searchDoneTasksForMatches(Command cmd) {
		ArrayList<Task> searchList = new ArrayList<Task>();
		for (Task task: data.getTaskList()) {
			if (task.getTextContent().contains(cmd.getTextContent())) {
				if(task.isDone())
					searchList.add(task);
			}
		}
		return searchList;
	}
	
	private ArrayList<Task> searchUndoneTasksForMatches(Command cmd) {
		ArrayList<Task> searchList = new ArrayList<Task>();
		for (Task task: data.getTaskList()) {
			if (task.getTextContent().contains(cmd.getTextContent())) {
				if(!task.isDone()){
					searchList.add(task);
				}
			}
		}
		return searchList;
	}

	private void sort(ArrayList<Task> list) {
		Collections.sort(list);
	}
}

class Data {
	private ArrayList<Task> taskList;
	private ArrayList<Task> searchList;
	private StorageInterface storageIO;
	private Gson gson;

	public Data() {
		storageIO = new StorageInterface();
		gson = new Gson();
		taskList = initializeTaskList();
		searchList = new ArrayList<Task>();
	}

	public Data(String testingFilePath) {
		storageIO = new StorageInterface(testingFilePath);
		gson = new Gson();
		taskList = initializeTaskList();
		searchList = new ArrayList<Task>();
	}

	public ArrayList<Task> getTaskList() {
		return taskList;
	}

	public ArrayList<Task> getSearchList() {
		return searchList;
	}

	public void saveToSearchList(ArrayList<Task> list) {
		searchList = list;
	}

	public void clearSearchList() {
		searchList.clear();
	}

	public void addToData(Task taskToAdd) {
		taskList.add(taskToAdd);
		sort();
		updateStorage();
	}

	public void updateStorage() {
		storageIO.saveToStorage(tasksToStrings());
	}

	public void removeFromData(Task taskToRemove) {
		taskList.remove(taskToRemove);
		updateStorage();
	}

	public void removeFromData(int lineNum) {
		taskList.remove(lineNum);
		updateStorage();
	}

	public Integer changeFileLocation(String location) {
		int changePathResult;
		changePathResult = storageIO.changeFilePath(location);
		if(changePathResult == LocalStorage.CHANGE_PATH_SUCCESS_FILE_EXIST){
			taskList = initializeTaskList();
			TokenManager.getInstance().clearToken();
		}
		return changePathResult;	
	}

	private ArrayList<Task> initializeTaskList() {
		ArrayList<String> listString = storageIO.readFromStorage();
		ArrayList<Task> listTask = new ArrayList<Task>();
		for (int i = 0; i < listString.size(); i++) {
			listTask.add(gson.fromJson(listString.get(i), Task.class));

		}

		return listTask;
	}

	private void sort() {
		Collections.sort(taskList);
	}

	private ArrayList<String> tasksToStrings() {
		ArrayList<String> taskStrings = new ArrayList<String>();
		for (int i = 0; i < taskList.size(); i++) {
			taskStrings.add(gson.toJson(taskList.get(i)));
		}
		return taskStrings;
	}

}

class StorageInterface {
	private LocalStorage file;
	private File filePath;
	public static final String FILE_PATH_TXT = "filePath.txt";
	public static String DEFAULT_FILE = "toDoo.txt";

	public StorageInterface() {
		filePath = new File(FILE_PATH_TXT);
		try {
			filePath.createNewFile();
		} catch (IOException ex) {
			ex.printStackTrace();
		}
		file = new LocalStorage(determineFilePath());
	}

	public StorageInterface(String testFilePath) {
		assert new File(testFilePath).exists() == true;
		DEFAULT_FILE = "testingTestController.txt";
		filePath = new File(testFilePath);
		try {
			filePath.createNewFile();
		} catch (IOException ex) {
			ex.printStackTrace();
		}
		file = new LocalStorage(determineFilePath());
	}

	public ArrayList<String> readFromStorage() {
		return file.readFile();
	}

	public void saveToStorage(ArrayList<String> list) {
		file.clear();
		file.saveToFile(list);
	}

	public Integer changeFilePath(String newPath) {
		BufferedWriter wr = null;
		BufferedReader br = null;
		String oldPath = null;
		int success = 0;
		try {
			br = new BufferedReader(new FileReader(filePath));
			oldPath = br.readLine();
			wr = new BufferedWriter(new FileWriter(filePath, false));
			wr.close();
			wr = new BufferedWriter(new FileWriter(filePath, true));
			wr.append(newPath);
			br.close();
			wr.close();
		} catch (IOException ex) {
			ex.printStackTrace();
			success = LocalStorage.WRONG_DIRECTORY;
		}
		if (success == 0) {
			success = file.changePath(newPath);
		}
		if (success == LocalStorage.WRONG_DIRECTORY) {
			try {
				if (oldPath == null) {
					oldPath = DEFAULT_FILE;
				}
				wr = new BufferedWriter(new FileWriter(filePath, false));
				wr.close();
				wr = new BufferedWriter(new FileWriter(filePath, true));
				wr.append(oldPath);
				wr.close();
				return LocalStorage.WRONG_DIRECTORY;
			} catch (IOException ex) {
				ex.printStackTrace();
				return LocalStorage.WRONG_DIRECTORY;
			}
		} else {
			return success;
		}
	}

	private String determineFilePath() {
		String text = null;
		BufferedReader br = null;
		BufferedWriter wr = null;
		boolean success = true;
		File tempfile;
		try {
			// determine storage path from filePath.txt in project directory
			br = new BufferedReader(new FileReader(filePath));
			wr = new BufferedWriter(new FileWriter(filePath, true));
			text = br.readLine();
			if (text == null) {
				// if filePath.txt is empty, write the default storage path into
				// it
				wr.append(DEFAULT_FILE);
				text = DEFAULT_FILE;
				wr.close();
				br.close();
			} else {
				// test if the path stored in filePath.txt is valid
				tempfile = new File(text);
				tempfile.createNewFile();
			}
		} catch (IOException ex) {
			success = false;
		}
		if (success == false) {
			try {
				wr = new BufferedWriter(new FileWriter(filePath, false));
				wr.close();
				wr = new BufferedWriter(new FileWriter(filePath, true));
				wr.append(DEFAULT_FILE);
				wr.close();
			} catch (IOException ex) {
				ex.printStackTrace();
			} finally {
				text = DEFAULT_FILE;
			}
		}
		return text;
	}

}

class Operation {
	private Task task;
	private Task prevTask;
	private Op op;

	public Operation(Task task, Task prevTask, Op op) {
		this.task = task;
		this.prevTask = prevTask;
		this.op = op;
	}

	public void undo(Data data) {
		int index;
		switch (op) {
		case ADD:
			data.removeFromData(task);
			break;
		case DELETE:
			data.addToData(task);
			break;
		case EDIT:
			index = data.getTaskList().indexOf(task);
			Task temp = data.getTaskList().get(index);
			temp.setgCalId(prevTask.getgCalId());
			temp.setLastServerUpdate(prevTask.getLastServerUpdate());
			temp.setLastLocalUpdate(prevTask.getLastLocalUpdate());
			temp.setDone(prevTask.isDone());
			temp.setPriority_argument(prevTask.getPriority_argument());
			temp.setType_argument(prevTask.getType_argument());
			temp.setStart_date(prevTask.getStart_date());
			temp.setEnd_date(prevTask.getEnd_date());
			temp.setPlace_argument(prevTask.getPlace_argument());
			break;
		case SETDONE:
			index = data.getTaskList().indexOf(task);
			data.getTaskList().get(index).setDone(false);
			break;
		default:
			index = data.getTaskList().indexOf(task);
			data.getTaskList().get(index).setDone(true);
		}
	}
}

enum Op {
	ADD, DELETE, EDIT, SETDONE, UNDONE
}
```
###### test\application\DataManagerTest.java
``` java
import static org.junit.Assert.assertEquals;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.util.ArrayList;

import org.junit.Test;

import com.google.gson.Gson;

import application.controller.DataManager;
import application.model.Command;
import application.model.LocalStorage;
import application.model.Parameter;
import application.model.Task;

public class DataManagerTest {
	
	LocalStorage file;
	ArrayList<Parameter> parameters = new ArrayList<Parameter>();
	ArrayList<Task> test = new ArrayList<Task>();
	Command cmd1 = new Command(3,"test.txt",parameters);
	Command cmd2 = new Command(2,"",parameters);
	Task task1 = new Task("go buy milk");
	Task task2 = new Task("go to school");
	Gson gson = new Gson();
	String filepath;
	@Test
	public void testList1() {
		
		BufferedReader br = null;
		try{
			br = new BufferedReader(new FileReader("filePath.txt"));
			filepath = br.readLine();
			br.close();
		}catch(IOException ex){
			ex.printStackTrace();
		}
		if (filepath == null){
			filepath = "toDoo.txt";
		}
		file = new LocalStorage(filepath);
		task2.setPlace_argument("nus");
		
		file.clear();
		ArrayList<String> list = new ArrayList<String>();
		list.add(gson.toJson(task1));
		list.add(gson.toJson(task2));
		file.saveToFile(list);
		
		
		parameters.clear();
		cmd2.setParameter(parameters);
		test.add(task1);
		test.add(task2);
		assertEquals(test,DataManager.getInstance().listAll(cmd2));
	}
	
	/* This is a boundary case for one parameter passed in to the listAll(Command cmd) method */
	@Test
	public void testList2(){
		task2.setPlace_argument("nus");
		
		BufferedReader br = null;
		try{
			br = new BufferedReader(new FileReader("filePath.txt"));
			filepath = br.readLine();
			br.close();
		}catch(IOException ex){
			ex.printStackTrace();
		}
		if (filepath == null){
			filepath = "toDoo.txt";
		}
		file = new LocalStorage(filepath);
		file.clear();
		ArrayList<String> list = new ArrayList<String>();
		list.add(gson.toJson(task1));
		list.add(gson.toJson(task2));
		file.saveToFile(list);
		
		parameters.clear();
		parameters.add(new Parameter(5,"nus"));
		cmd2.setParameter(parameters);
		test.clear();
		test.add(task2);
		assertEquals(test,DataManager.getInstance().listAll(cmd2));
	}
	
	/* This is a boundary case for multiple parameters passed in to the listAll(Command cmd) method */
	@Test
	public void testList3(){
		task2.setPlace_argument("nus");
		BufferedReader br = null;
		try{
			br = new BufferedReader(new FileReader("filePath.txt"));
			filepath = br.readLine();
			br.close();
		}catch(IOException ex){
			ex.printStackTrace();
		}
		if (filepath == null){
			filepath = "toDoo.txt";
		}
		file = new LocalStorage(filepath);
		file.clear();
		ArrayList<String> list = new ArrayList<String>();
		list.add(gson.toJson(task1));
		list.add(gson.toJson(task2));
		file.saveToFile(list);
		
		parameters.clear();
		parameters.add(new Parameter(2, "normal"));
		parameters.add(new Parameter(1, "normal"));
		cmd2.setParameter(parameters);
		test.clear();
		test.add(task1);
		test.add(task2);
		assertEquals(test,DataManager.getInstance().listAll(cmd2));
	}
}
```
